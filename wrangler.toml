name = "geo-verification"
main = "src/index.ts"
compatibility_date = "2026-02-03"
keep_vars = true

[durable_objects]
bindings = [
  { name = "VERIFICATION_MANAGER", class_name = "VerificationManager" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["VerificationManager", "UserRateLimiter"]

[[migrations]]
tag = "v2"
deleted_classes = ["UserRateLimiter"]

[triggers]
crons = ["0 4 * * *"]

# Variables set via Cloudflare Dashboard (keep_vars = true preserves them on deploy):
# - CODE_EXPIRY_MINUTES
# - RATE_LIMIT_PER_HOUR
# - ALLOWED_CALLBACK_HOSTS
#
# Secrets (set via `wrangler secret put`):
# - GEOGUESSR_NCFA_TOKEN (required)
# - API_KEY (optional)
